<!--
 * @Author: 黄遥
 * @Date: 2020-05-30 15:18:16
 * @LastEditors: 黄遥
 * @LastEditTime: 2020-05-30 15:45:23
 * @Description: file content
--> 
## TCP三次握手
所谓的三次握手是指在使用tcp建立通信时，通信双方总共需要发送三个确认数据包来确认连接的建立

第一次握手：客户端向服务端发出connect请求，给服务端发送一个SYN数据包（SYN=1）,然后等待服务端的回复，此时客户端进入SYN_SENT状态
第二次握手：服务端在收到客户端的SYN包后进行确认(ack=J+1），同时给客户端也发送一个SYN+ACK包(SYN=1,ACK=1)，服务端进入SYN_RCVD状态。
第三次握手：客户端在收到服务端的SYN+ACK包之后，向服务端发送一个ACK确认包(ack=K+1)，此包发送完成之后双方进入ESTABLISHED状态，三次握手完成。

### SYN攻击
在三次握手过程中，Server发送SYN-ACK之后，收到Client的ACK之前的TCP连接称为半连接。此时 Server 处于 SYN_RCVD 状态，当收到 ACK 后，Server 转入ESTABLISHED状态。SYN 攻击就是 client 在短时间内伪造大量不存在的 IP 地址，并向 Server 不断的发送 SYN 包，Server 回复确认包，并等待 Client 的确认，由于源地址是不存在的，因此，Server 需要不断重发直至超时，这些伪造的 SYN 包将产生时间占用为连接队列，导致正常的SYN请求因为队列满而被丢弃，从而引起网络堵塞甚至系统瘫痪。

## TCP四次挥手
所谓四次挥手就是指当断开一个tcp连接时需要通信双发送四个确认包来确认连接断开。
第一次挥手：客户端在数据发送完毕之后，给服务端发送一个FIN包请求断开连接，此客户端进入FIN_WAIT状态
第二次挥手：服务端在收到客户端发来的FIN包之后，给客户端发送一个ACK确认包，此时服务端进入CLOSE_WAIT状态，客户端进入FIN_WAIT2状态
第三次挥手：服务端在数据接收完毕之后，也向客户端发送一个FIN包请求断开连接，此时服务端进入LAST_ACK状态。
第四次挥手：客户端收到服务端的FIN包之后进入TIME_WAIT状态，发送一个ACK包(ack=K+!)给服务端，服务端进入CLOSED状态

为什么tcp建立连接需要三次握手？
双方都进行确认是否具有数据收发能力，两次不安全，四次没必要
三次握手是为了防止，客户端的请求报文在网络滞留，客户端超时重传了请求报文，服务端建立连接，传输数据，释放连接之后，服务器又收到了客户端滞留的请求报文，建立连接一直等待客户端发送数据。
服务器对客户端的请求进行回应(第二次握手)后，就会理所当然的认为连接已建立，而如果客户端并没有收到服务器的回应呢？此时，客户端仍认为连接未建立，服务器会对已建立的连接保存必要的资源，如果大量的这种情况，服务器会崩溃。

为什么tcp断开连接需要四次挥手？
接收端被动关闭方接收到请求会后，进行ack确认，但是操作系统需要 用户处理完所有数据之后调用close才会发送FIN包

https://blog.csdn.net/weixin_42237990/article/details/95031969